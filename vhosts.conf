
server {
        listen       80;
        server_name  www.test.com test.com;
        root   "D:/WWW/WebRoot/ThinkPHP";
        location / {
            index  index.html index.htm index.php;
            #autoindex  on;
        }
        location ~ \.php(.*)$ {
            fastcgi_pass   127.0.0.1:9000;
            fastcgi_index  index.php;
            fastcgi_split_path_info  ^((?U).+\.php)(/?.+)$;
            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
            fastcgi_param  PATH_INFO  $fastcgi_path_info;
            fastcgi_param  PATH_TRANSLATED  $document_root$fastcgi_path_info;
            include        fastcgi_params;
        }
}
server {
        listen       80;
        server_name  mapi.7gz.com mapi.7gz.com;
        root   "D:/WWW/local/mapi.7gz.com/trunk";
        location / {
            index  index.html index.htm index.php;
            #autoindex  on;
        }
        location ~ \.php(.*)$ {
            fastcgi_pass   127.0.0.1:9000;
            fastcgi_index  index.php;
            fastcgi_split_path_info  ^((?U).+\.php)(/?.+)$;
            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
            fastcgi_param  PATH_INFO  $fastcgi_path_info;
            fastcgi_param  PATH_TRANSLATED  $document_root$fastcgi_path_info;
            include        fastcgi_params;
            
            
            # vfs
            fastcgi_param SINASRV_VFS_TEST_SERVER "127.0.0.1";
            fastcgi_param SINASRV_WVFS_SERVERS "127.0.0.1";

            # MemCache
            fastcgi_param SINASRV_MEMCACHED_SERVERS "10.207.4.252:11211";
            fastcgi_param SINASRV_MEMCACHED_MIRROR_SERVERS "10.207.4.252:11211";
            fastcgi_param SINASRV_MEMCACHED_KEY_PREFIX "mapi_";

            # Redis
            fastcgi_param SINASRV_REDIS_HOST "10.207.4.252:6379";
            fastcgi_param SINASRV_REDIS_HOST_R "10.207.4.252:6379";

            # mongo
            fastcgi_param SINASRV_MONGO_DB_HOST "10.207.4.252";
            fastcgi_param SINASRV_MONGO_DB_PORT "27017";
            fastcgi_param SINASRV_MONGO_DB_USER "leju";
            fastcgi_param SINASRV_MONGO_DB_PASS "leju";
            fastcgi_param SINASRV_MONGO_DB_NAME "leju_com";
            fastcgi_param SINASRV_MONGO_DB_HOST_R "10.207.4.252";
            fastcgi_param SINASRV_MONGO_DB_PORT_R "27017";
            fastcgi_param SINASRV_MONGO_DB_USER_R "leju";
            fastcgi_param SINASRV_MONGO_DB_PASS_R "leju";
            fastcgi_param SINASRV_MONGO_DB_NAME_R "leju_com";

            # mapi mongo
            fastcgi_param SINASRV_MONGO_DB_MAPI_HOST "10.207.4.252";
            fastcgi_param SINASRV_MONGO_DB_MAPI_PORT "27017";
            fastcgi_param SINASRV_MONGO_DB_MAPI_USER "leju";
            fastcgi_param SINASRV_MONGO_DB_MAPI_PASS "leju";
            fastcgi_param SINASRV_MONGO_DB_MAPI_NAME "leju_com";
            fastcgi_param SINASRV_MONGO_DB_MAPI_HOST_R "10.207.4.252";
            fastcgi_param SINASRV_MONGO_DB_MAPI_PORT_R "27017";
            fastcgi_param SINASRV_MONGO_DB_MAPI_USER_R "leju";
            fastcgi_param SINASRV_MONGO_DB_MAPI_PASS_R "leju";
            fastcgi_param SINASRV_MONGO_DB_MAPI_NAME_R "leju_com";

            # mapi mysql
            fastcgi_param SINASRV_DB_HOST "10.207.4.252";
            fastcgi_param SINASRV_DB_PORT "3306";
            fastcgi_param SINASRV_DB_USER "mapi";
            fastcgi_param SINASRV_DB_PASS "jiajumapi";
            fastcgi_param SINASRV_DB_NAME "gongzhang_test";

            fastcgi_param SINASRV_DB_HOST_R "10.207.4.252";
            fastcgi_param SINASRV_DB_PORT_R "3306";
            fastcgi_param SINASRV_DB_USER_R "mapi";
            fastcgi_param SINASRV_DB_PASS_R "jiajumapi";
            fastcgi_param SINASRV_DB_NAME_R "gongzhang_test";
       		

            # master mysql 
            #fastcgi_param SINASRV_DB_HOST "10.207.4.253"; 
            #fastcgi_param SINASRV_DB_PORT "3306"; 
            #fastcgi_param SINASRV_DB_USER "root"; 
            #fastcgi_param SINASRV_DB_PASS "jiajutest"; 
            #fastcgi_param SINASRV_DB_NAME "gongzhang_jiaju_sina_com_cn"; 

            # slave mysql 
            #fastcgi_param SINASRV_DB_HOST_R "10.207.4.253"; 
            #fastcgi_param SINASRV_DB_PORT_R "3306"; 
            #fastcgi_param SINASRV_DB_USER_R "root"; 
            #fastcgi_param SINASRV_DB_PASS_R "jiajutest"; 
            #fastcgi_param SINASRV_DB_NAME_R "gongzhang_jiaju_sina_com_cn"; 
        }
}
server {
        listen       80;
        server_name  newmapi.7gz.com newmapi.7gz.com;
        root   "D:/WWW/local/newmapi.7gz.com/trunk";
        location / {
            index  index.html index.htm index.php;
            #autoindex  on;
        }
        location ~ \.php(.*)$ {
            fastcgi_pass   127.0.0.1:9000;
            fastcgi_index  index.php;
            fastcgi_split_path_info  ^((?U).+\.php)(/?.+)$;
            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
            fastcgi_param  PATH_INFO  $fastcgi_path_info;
            fastcgi_param  PATH_TRANSLATED  $document_root$fastcgi_path_info;
            include        fastcgi_params;
            
            
            fastcgi_param SINASRV_NDATA_DIR "/home/mydata/www/ndata/7gz";
            fastcgi_param SINASRV_CACHE_DIR "/home/mydata/www/ndata/cache";
            #fastcgi_param SINASRV_NDATA_CACHE_URL "http://st.jiaju.com/malljiaju/";
            fastcgi_param SINASRV_NDATA_CACHE_URL "http://www.7gz.com/cache/";

            # vfs
            fastcgi_param SINASRV_VFS_TEST_SERVER "127.0.0.1";
            fastcgi_param SINASRV_WVFS_SERVERS "127.0.0.1";

            # MemCache
            fastcgi_param SINASRV_MEMCACHED_SERVERS "10.207.4.252:11211";
            fastcgi_param SINASRV_MEMCACHED_MIRROR_SERVERS "10.207.4.252:11211";
            fastcgi_param SINASRV_MEMCACHED_KEY_PREFIX "mapi_";

            # Redis
            fastcgi_param SINASRV_REDIS_HOST "10.207.4.252:6379";
            fastcgi_param SINASRV_REDIS_HOST_R "10.207.4.252:6379";

            # Redis
            #fastcgi_param SINASRV_REDIS_HOST "127.0.0.1:6379";
            #fastcgi_param SINASRV_REDIS_HOST_R "127.0.0.1:6379";

            # mongo
            fastcgi_param SINASRV_MONGO_DB_HOST "10.207.4.252";
            fastcgi_param SINASRV_MONGO_DB_PORT "27017";
            fastcgi_param SINASRV_MONGO_DB_USER "leju";
            fastcgi_param SINASRV_MONGO_DB_PASS "leju";
            fastcgi_param SINASRV_MONGO_DB_NAME "leju_com";
            fastcgi_param SINASRV_MONGO_DB_HOST_R "10.207.4.252";
            fastcgi_param SINASRV_MONGO_DB_PORT_R "27017";
            fastcgi_param SINASRV_MONGO_DB_USER_R "leju";
            fastcgi_param SINASRV_MONGO_DB_PASS_R "leju";
            fastcgi_param SINASRV_MONGO_DB_NAME_R "leju_com";

            # mapi mongo
            fastcgi_param SINASRV_MONGO_DB_MAPI_HOST "10.207.4.252";
            fastcgi_param SINASRV_MONGO_DB_MAPI_PORT "27017";
            fastcgi_param SINASRV_MONGO_DB_MAPI_USER "leju";
            fastcgi_param SINASRV_MONGO_DB_MAPI_PASS "leju";
            fastcgi_param SINASRV_MONGO_DB_MAPI_NAME "leju_com";
            fastcgi_param SINASRV_MONGO_DB_MAPI_HOST_R "10.207.4.252";
            fastcgi_param SINASRV_MONGO_DB_MAPI_PORT_R "27017";
            fastcgi_param SINASRV_MONGO_DB_MAPI_USER_R "leju";
            fastcgi_param SINASRV_MONGO_DB_MAPI_PASS_R "leju";
            fastcgi_param SINASRV_MONGO_DB_MAPI_NAME_R "leju_com";

            # mapi mysql
            fastcgi_param SINASRV_DB_HOST "10.207.4.252";
            fastcgi_param SINASRV_DB_PORT "3306";
            fastcgi_param SINASRV_DB_USER "mapi";
            fastcgi_param SINASRV_DB_PASS "jiajumapi";
            fastcgi_param SINASRV_DB_NAME "mapi_7gz_com";

            fastcgi_param SINASRV_DB_HOST_R "10.207.4.252";
            fastcgi_param SINASRV_DB_PORT_R "3306";
            fastcgi_param SINASRV_DB_USER_R "mapi";
            fastcgi_param SINASRV_DB_PASS_R "jiajumapi";
            fastcgi_param SINASRV_DB_NAME_R "mapi_7gz_com";
        }
}
server {
        listen       80;
        server_name  www.7gz.com m.7gz.com;
        root   "D:/WWW/local/www.7gz.com/trunk";
        location / {
            index  index.html index.htm index.php;
            #autoindex  on;
            #域名重定向
            if ($http_host ~* "^m.qianggongzhang.com"){
                rewrite ^/(.*) http://m.7gz.com/ last;
            }
            if ($http_host ~* "^sinagz.com.cn|^qianggongzhang.com"){
                rewrite ^/(.*)$ http://www.7gz.com$uri permanent;
            }
            if ($http_host ~* "^(gongzhang|gzclub)\.jiaju\.sina\.com\.cn"){
                rewrite ^/(.*)$ http://www.7gz.com permanent;
            }
            if ($http_host ~* "(\w+)\.sinazx\.com"){
                rewrite ^/(.*)$ http://$1.7gz.com permanent;
            }
            #SEO手机网址效果图
            if ($http_host ~* "^m.7gz.com"){
                rewrite ^/(/)p\.html /p.php last;
                rewrite ^/(/)?xgt/?$ /Gallery/index last;
                rewrite ^/(/)?xgt/(\d+)?$ /Gallery/search/q/$2 last;
                rewrite ^/(/)?xgt/tp-(\d+)(\.html)?$ /Gallery/info/id/$2 last;
                rewrite ^/(/)?xgt/([A-Z]|0\-9)(-)?(\d+)?$ /Gallery/keyword/initial/$2 last;
            }
            #SEO PC
            if ($http_host ~* "^xiaoguotu.7gz.com"){
                rewrite ^/(/)?$ /Seo/ZxPic/index last;
                rewrite ^/?fenlei/?$ /Seo/ZxPic/hotwords last;
                rewrite ^/?([A-Z]|0\-9)(-)?(\d+)?/?$ /Seo/ZxPic/keywords?initial=$1&p=$3 last;
                rewrite ^/?(\d+)(-)?(\d+)?/?$ /Seo/ZxPic/hotDetail?id=$1&p=$3 last;
                rewrite ^/?tupian/?(\d+)?\.html$ /Seo/ZxPic/picDetail?id=$1 last;
                rewrite ^/zixun/(\d+)\.html$ /Home/Common/error;
            }

            #sitemap主文件
            rewrite ^/?sitemap-([a-z]+)\.xml$ /Seo/SiteMap/getMainXml/clas/$1 last;
            rewrite ^/?sitemap.xml$ /Seo/SiteMap/index last;
            #sitemap子文件
            rewrite ^/?([a-z]+)_(\d+)\.xml$ /Seo/SiteMap/getChildrenXml/clas/$1/id/$2 last;

            #新闻资讯
            rewrite ^/?zixun/(\d+)/(\d+)\.html$ /News/detail/id/$1/p/$2 last;
            rewrite ^/?zixun/(\d+)\.html$ /News/detail/id/$1 last;
            rewrite ^/?(space|style|housetype|materialtag|processtag)(-t(\d+))?(-c(\d+))?(-p(\d+))?/?$ /Tag/tagslist?type=$1&tags=$3&cid=$5&p=$7 last;
            rewrite ^/?zixun/(\d+)/?(\d*)/?$ /News/xwzx/id/$1/p/$2 last;
            #资讯热词详情页
            rewrite ^/?redian/?(\d+)(-)?(\d+)?/?$ /Seo/ZxPic/hotDetailNews?id=$1&p=$3 last;
            #专属设计详情页
			rewrite ^/?designer/(\d+)_(\d+)_(\d+)\.html$ /house_type/index/xq_id/$1/house_type_id/$2/case_id/$3 last;
			#专属设计详情页 全景图
            rewrite ^/?designer-3d/(\d+)_(\d+)_(\d+)\.html/?$ /house_type/panorama/xq_id/$1/house_type_id/$2/case_id/$3 last;
            #专属设计
            rewrite ^/?design/?-?(\d*)/?$ /xq_list/index/p/$1 last;
            rewrite ^/?design/?([^\/-]*)/?-?(\d*)/?$ /xq_list/index/city/$1/p/$2 last;
            rewrite ^/?design/?([^\/]*)/?([^\/-]*)/?-?(\d*)/?$ /xq_list/index/city/$1/district/$2/p/$3 last;
            #BTV生活+
            rewrite ^/?live/?(\d*)/?$ /Live/index/cid/11/p/$1 last;
            rewrite ^/?live/(\d+)\.html$ /Live/detail/id/$1 last;
            #视频列表
            rewrite ^/?shipin/?(\d*)/?$ /video/index/cid/7/p/$1 last;
            rewrite ^/?shipin/(\d+)\.html$ /video/detail/id/$1 last;
            rewrite ^/?btv/?(\d*)/?$ /video/index/cid/8/p/$1 last;
            rewrite ^/?btv/(\d+)\.html$ /video/detail/id/$1 last;
            #评论列表页
            rewrite ^/?pinglun/?(\d*)/?$ /comment/index/p/$1 last;
            #活动
            rewrite ^/?huodong/?(\d*)/?$ /activity/index/p/$1 last;
            rewrite ^/?huodong/huigu/?(\d*)/?$ /activity/reviewList/p/$1 last;
            rewrite ^/?huodong/?(\d*).html/?$ /activity/detail/id/$1 last;
            rewrite ^/?huodong/map/?(\d*).html/?$ /activity/map/id/$1 last;
            rewrite ^/?youhui/?$ /booking last;
            #专题活动
            rewrite ^/?activityzt/(\w+)?/?$ /ActivityZt/index/code/$1 last;
            #看案例页面
            rewrite ^/?anli/?$ /zxAlbum/ last;
            #空间分类列表页
            rewrite ^/?(keting|canting|woshi|chufang|weishengjian|shufang|ertongfang|yangtai|xuanguan|yimaojian)(-o(\d+))?(-p(\d+))?/?$ /zx_case/spaceList?space=$1&order=$3&p=$5 last;
            #案例详情页
            rewrite ^/?anli/(\d+)\.html$ /zx_case/detail/id/$1 last;
            #辅料仓库
            rewrite ^/?fuliao(-b([^\/-]+))?(-c([a-z]+))?(-tc(\d+))?(-sc(\d+))?(-p(\d+))?/?$ /Goods/index?brand=$2&city=$4&thirdCate=$6&secondCate=$8&p=$9;
            #订单明细
            rewrite ^/?fuliao-dd(\d+)\.html/?$ /Index/contractOrderDetail/id/$1;
            #工长首页
            rewrite ^/?gongzhang/?$ /Chief/index;
            #工长详情页
            rewrite ^/?gongzhang/(\d+).html$ /Chief/detail/id/$1 last;
            #开工动态分页
            rewrite ^/?gongzhang/dongtai-(\d+) /decorating/index?p=$1 last;
            #开工动态
            rewrite ^/?gongzhang/dongtai/?$ /decorating/index last;

            if (!-e $request_filename) {
                rewrite  ^(.*)$  /index.php?s0=$1  last;
                break;
            }
        }
        location ~ \.php(.*)$ {
            fastcgi_pass   127.0.0.1:9000;
            fastcgi_index  index.php;
            fastcgi_split_path_info  ^((?U).+\.php)(/?.+)$;
            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
            fastcgi_param  PATH_INFO  $fastcgi_path_info;
            fastcgi_param  PATH_TRANSLATED  $document_root$fastcgi_path_info;
            include        fastcgi_params;
            
            
            fastcgi_param SERVER_ALIAS  "www.qianggongzhang.com";

            fastcgi_param SINASRV_DB_HOST "10.207.4.252";
            fastcgi_param SINASRV_DB_PORT "3306";
            fastcgi_param SINASRV_DB_USER "mapi";
            fastcgi_param SINASRV_DB_PASS "jiajumapi";
            fastcgi_param SINASRV_DB_NAME "gongzhang_test";
            fastcgi_param SINASRV_DB_HOST_R "10.207.4.252";
            fastcgi_param SINASRV_DB_PORT_R "3306";
            fastcgi_param SINASRV_DB_USER_R "mapi";
            fastcgi_param SINASRV_DB_PASS_R "jiajumapi";
            fastcgi_param SINASRV_DB_NAME_R "gongzhang_test";

            #MemCache
            fastcgi_param SINASRV_MEMCACHED_SERVERS "10.207.4.252:11211";
            fastcgi_param SINASRV_MEMCACHED_MIRROR_SERVERS "10.207.4.252:11211";
            fastcgi_param SINASRV_MEMCACHED_KEY_PREFIX "7gz";

            #Redis
            fastcgi_param SINASRV_REDIS_HOST "10.207.4.252:6379";
            fastcgi_param SINASRV_REDIS_HOST_R "10.207.4.252:6379";

            #mongo
            fastcgi_param SINASRV_MONGO_DB_HOST "10.207.4.252";
            fastcgi_param SINASRV_MONGO_DB_PORT "9001";
            fastcgi_param SINASRV_MONGO_DB_USER "leju";
            fastcgi_param SINASRV_MONGO_DB_PASS "leju";
            fastcgi_param SINASRV_MONGO_DB_NAME "leju_com";
            fastcgi_param SINASRV_MONGO_DB_HOST_R "10.207.4.252";
            fastcgi_param SINASRV_MONGO_DB_PORT_R "9001";
            fastcgi_param SINASRV_MONGO_DB_USER_R "leju";
            fastcgi_param SINASRV_MONGO_DB_PASS_R "leju";
            fastcgi_param SINASRV_MONGO_DB_NAME_R "leju_com";

            fastcgi_param SINASRV_NDATA_DIR "/home/mydata/www/ndata/7gz";
            fastcgi_param SINASRV_CACHE_DIR "/home/mydata/www/ndata/cache";
            fastcgi_param SINASRV_NDATA_CACHE_URL "http://www.7gz.com/cache/";

            # vfs
            fastcgi_param SINASRV_VFS_TEST_SERVER "127.0.0.1";
            fastcgi_param SINASRV_WVFS_SERVERS "127.0.0.1";
        }
}